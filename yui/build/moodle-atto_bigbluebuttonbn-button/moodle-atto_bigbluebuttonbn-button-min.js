YUI.add("moodle-atto_recordrtc-button",function(a,b){var c="atto_recordrtc",d="recordrtc",e=!1;a.namespace("M.atto_recordrtc").Button=a.Base.create("button",a.M.editor_atto.EditorPlugin,[],{initializer:function(){var b=this.addButton({icon:"icon",iconComponent:"atto_recordrtc",callback:this._toggle});b.set("title",M.util.get_string("pluginname",c)),a.after("windowresize",a.bind(this._fitToScreen,this)),this.editor.on(["gesturemove","gesturemoveend"],a.bind(this._fitToScreen,this),{standAlone:!0},this),this.toolbar.on("click",a.bind(this._fitToScreen,this)),a.namespace("M.atto_recordrtc").atto_recordrtc_button=this},_toggle:function(a){console.info("Toggle..."),a.preventDefault(),this._toggle_action()},_toggle_action:function(){console.info("Toggle Action...");var b=this.buttons[d],c=a.one("#id_submitbutton");b.getData(e)?(this.unHighlightButtons(d),this._setrecordrtc(b),c.set("disabled",!1),c.removeClass("disabled")):(this.highlightButtons(d),this._setrecordrtc(b,!0),c.set("disabled",!0),c.addClass("disabled"))},_fitToScreen:function(){var a=this.buttons[d];if(a.getData(e)){var b=this.get("host");this.recordrtc.setStyles({position:"absolute",height:b.editor.getComputedStyle("height"),width:b.editor.getComputedStyle("width"),top:b.editor.getComputedStyle("top"),left:b.editor.getComputedStyle("left")}),this.recordrtc.setY(this.editor.getY())}},_setrecordrtc:function(b,c){var d=this.get("host");if(c){this.recordrtc=a.Node.create('<iframe src="'+this.get("recordrtcurl")+"?sesskey="+this.get("sesskey")+"&contextid="+this.get("contextid")+"&content="+encodeURIComponent(d.textarea.get("value"))+'" srcdoc=""></iframe'),this.recordrtc.setStyles({backgroundColor:a.one("body").getComputedStyle("backgroundColor"),backgroundImage:"url("+M.util.image_url("i/loading","core")+")",backgroundRepeat:"no-repeat",backgroundPosition:"center center"}),d._wrapper.appendChild(this.recordrtc);var f={sesskey:this.get("sesskey"),contextid:this.get("contextid"),content:d.textarea.get("value")};a.io(this.get("recordrtcurl"),{context:this,data:f,on:{complete:this._loadContent},method:"POST"}),d.disablePlugins(),d.enablePlugins(this.name),"undefined"!=typeof a.M.atto_fullscreen&&d.enablePlugins("fullscreen")}else this.recordrtc.remove(!0),d.enablePlugins();b.setData(e,!!c),this._fitToScreen()},_loadContent:function(a,b){var c=b.responseText;this.recordrtc.setAttribute("srcdoc",c)},_annotate:function(a){}},{ATTRS:{recordrtcurl:{value:null},contextid:{value:null},sesskey:{value:null}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});