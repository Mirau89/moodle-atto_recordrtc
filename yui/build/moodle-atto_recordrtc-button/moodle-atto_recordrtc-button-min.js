YUI.add("moodle-atto_recordrtc-button",function(e,t){var n="atto_recordrtc",r="recordrtc",i=!1,s;e.namespace("M.atto_recordrtc").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){var t=this.addButton({icon:"icon",iconComponent:"atto_recordrtc",callback:this._toggle});t.set("title",M.util.get_string("pluginname",n)),e.after("windowresize",e.bind(this._fitToScreen,this)),this.editor.on(["gesturemove","gesturemoveend"],e.bind(this._fitToScreen,this),{standAlone:!0},this),this.toolbar.on("click",e.bind(this._fitToScreen,this)),e.namespace("M.atto_recordrtc").atto_recordrtc_button=this},_toggle:function(e){e.preventDefault(),this._toggle_action()},_toggle_action:function(){var t=this.buttons[r],n=e.one("#id_submitbutton");t.getData(i)?(this.unHighlightButtons(r),this._setrecordrtc(t),n.set("disabled",!1),n.removeClass("disabled")):(this.highlightButtons(r),this._setrecordrtc(t,!0),n.set("disabled",!0),n.addClass("disabled"))},_fitToScreen:function(){var e=this.buttons[r];if(!e.getData(i))return;var t=this.get("host");this.recordrtc.setStyles({position:"absolute",height:t.editor.getComputedStyle("height"),width:t.editor.getComputedStyle("width"),top:t.editor.getComputedStyle("top"),left:t.editor.getComputedStyle("left")}),this.recordrtc.setY(this.editor.getY())},_setrecordrtc:function(t,n){var r=this.get("host");if(n){this.recordrtc=e.Node.create('<iframe src="'+this.get("recordrtcurl")+"?sesskey="+this.get("sesskey")+"&contextid="+this.get("contextid")+"&content="+encodeURIComponent(r.textarea.get("value"))+'" srcdoc=""></iframe'),this.recordrtc.setStyles({backgroundColor:e.one("body").getComputedStyle("backgroundColor"),backgroundImage:"url("+M.util.image_url("i/loading","core")+")",backgroundRepeat:"no-repeat",backgroundPosition:"center center"}),r._wrapper.appendChild(this.recordrtc);var s={sesskey:this.get("sesskey"),contextid:this.get("contextid"),content:r.textarea.get("value")};e.io(this.get("recordrtcurl"),{context:this,data:s,on:{complete:this._loadContent},method:"POST"}),r.disablePlugins(),r.enablePlugins(this.name),typeof e.M.atto_fullscreen!="undefined"&&r.enablePlugins("fullscreen")}else this.recordrtc.remove(!0),r.enablePlugins();t.setData(i,!!n),this._fitToScreen()},_loadContent:function(e,t){var n=t.responseText;this.recordrtc.setAttribute("srcdoc",n)},_annotate:function(e){}},{ATTRS:{recordrtcurl:{value:null},contextid:{value:null},sesskey:{value:null}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
