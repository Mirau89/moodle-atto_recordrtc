if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/moodle-atto_recordrtc-videomodule/moodle-atto_recordrtc-videomodule.js']) {
   __coverage__['build/moodle-atto_recordrtc-videomodule/moodle-atto_recordrtc-videomodule.js'] = {"path":"build/moodle-atto_recordrtc-videomodule/moodle-atto_recordrtc-videomodule.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":45},"end":{"line":1,"column":64}}},"2":{"name":"(anonymous_2)","line":29,"loc":{"start":{"line":29,"column":31},"end":{"line":29,"column":42}}},"3":{"name":"(anonymous_3)","line":44,"loc":{"start":{"line":44,"column":27},"end":{"line":44,"column":38}}},"4":{"name":"(anonymous_4)","line":72,"loc":{"start":{"line":72,"column":33},"end":{"line":72,"column":50}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":32},"end":{"line":82,"column":51}}},"6":{"name":"(anonymous_6)","line":87,"loc":{"start":{"line":87,"column":40},"end":{"line":87,"column":56}}},"7":{"name":"(anonymous_7)","line":97,"loc":{"start":{"line":97,"column":42},"end":{"line":97,"column":53}}},"8":{"name":"(anonymous_8)","line":126,"loc":{"start":{"line":126,"column":40},"end":{"line":126,"column":51}}},"9":{"name":"(anonymous_9)","line":134,"loc":{"start":{"line":134,"column":23},"end":{"line":134,"column":34}}},"10":{"name":"(anonymous_10)","line":152,"loc":{"start":{"line":152,"column":39},"end":{"line":152,"column":56}}},"11":{"name":"(anonymous_11)","line":164,"loc":{"start":{"line":164,"column":8},"end":{"line":164,"column":35}}},"12":{"name":"(anonymous_12)","line":173,"loc":{"start":{"line":173,"column":8},"end":{"line":173,"column":24}}},"13":{"name":"(anonymous_13)","line":179,"loc":{"start":{"line":179,"column":35},"end":{"line":179,"column":52}}},"14":{"name":"(anonymous_14)","line":184,"loc":{"start":{"line":184,"column":31},"end":{"line":184,"column":47}}},"15":{"name":"(anonymous_15)","line":202,"loc":{"start":{"line":202,"column":24},"end":{"line":202,"column":35}}},"16":{"name":"(anonymous_16)","line":211,"loc":{"start":{"line":211,"column":55},"end":{"line":211,"column":90}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":235,"column":70}},"2":{"start":{"line":29,"column":0},"end":{"line":149,"column":2}},"3":{"start":{"line":31,"column":4},"end":{"line":31,"column":52}},"4":{"start":{"line":32,"column":4},"end":{"line":32,"column":63}},"5":{"start":{"line":33,"column":4},"end":{"line":33,"column":56}},"6":{"start":{"line":34,"column":4},"end":{"line":34,"column":22}},"7":{"start":{"line":36,"column":4},"end":{"line":36,"column":88}},"8":{"start":{"line":39,"column":4},"end":{"line":39,"column":38}},"9":{"start":{"line":41,"column":4},"end":{"line":41,"column":39}},"10":{"start":{"line":44,"column":4},"end":{"line":148,"column":6}},"11":{"start":{"line":45,"column":8},"end":{"line":45,"column":23}},"12":{"start":{"line":46,"column":8},"end":{"line":46,"column":28}},"13":{"start":{"line":49,"column":8},"end":{"line":147,"column":9}},"14":{"start":{"line":53,"column":12},"end":{"line":53,"column":71}},"15":{"start":{"line":54,"column":12},"end":{"line":54,"column":68}},"16":{"start":{"line":57,"column":12},"end":{"line":57,"column":72}},"17":{"start":{"line":60,"column":12},"end":{"line":63,"column":13}},"18":{"start":{"line":61,"column":16},"end":{"line":61,"column":68}},"19":{"start":{"line":62,"column":16},"end":{"line":62,"column":57}},"20":{"start":{"line":66,"column":12},"end":{"line":66,"column":24}},"21":{"start":{"line":67,"column":12},"end":{"line":67,"column":25}},"22":{"start":{"line":70,"column":12},"end":{"line":116,"column":14}},"23":{"start":{"line":74,"column":20},"end":{"line":74,"column":40}},"24":{"start":{"line":76,"column":20},"end":{"line":78,"column":21}},"25":{"start":{"line":77,"column":24},"end":{"line":77,"column":52}},"26":{"start":{"line":83,"column":20},"end":{"line":83,"column":47}},"27":{"start":{"line":88,"column":20},"end":{"line":88,"column":40}},"28":{"start":{"line":91,"column":20},"end":{"line":111,"column":21}},"29":{"start":{"line":92,"column":24},"end":{"line":101,"column":27}},"30":{"start":{"line":98,"column":36},"end":{"line":98,"column":52}},"31":{"start":{"line":103,"column":24},"end":{"line":103,"column":92}},"32":{"start":{"line":104,"column":27},"end":{"line":111,"column":21}},"33":{"start":{"line":106,"column":24},"end":{"line":106,"column":83}},"34":{"start":{"line":107,"column":24},"end":{"line":107,"column":83}},"35":{"start":{"line":108,"column":24},"end":{"line":108,"column":170}},"36":{"start":{"line":110,"column":24},"end":{"line":110,"column":93}},"37":{"start":{"line":114,"column":20},"end":{"line":114,"column":58}},"38":{"start":{"line":119,"column":12},"end":{"line":119,"column":72}},"39":{"start":{"line":120,"column":12},"end":{"line":120,"column":36}},"40":{"start":{"line":123,"column":12},"end":{"line":123,"column":63}},"41":{"start":{"line":126,"column":12},"end":{"line":128,"column":14}},"42":{"start":{"line":127,"column":16},"end":{"line":127,"column":71}},"43":{"start":{"line":131,"column":12},"end":{"line":131,"column":43}},"44":{"start":{"line":134,"column":12},"end":{"line":136,"column":21}},"45":{"start":{"line":135,"column":16},"end":{"line":135,"column":37}},"46":{"start":{"line":139,"column":12},"end":{"line":139,"column":57}},"47":{"start":{"line":142,"column":12},"end":{"line":142,"column":84}},"48":{"start":{"line":143,"column":12},"end":{"line":146,"column":13}},"49":{"start":{"line":144,"column":16},"end":{"line":144,"column":60}},"50":{"start":{"line":145,"column":16},"end":{"line":145,"column":65}},"51":{"start":{"line":152,"column":0},"end":{"line":177,"column":2}},"52":{"start":{"line":153,"column":4},"end":{"line":176,"column":6}},"53":{"start":{"line":166,"column":12},"end":{"line":166,"column":48}},"54":{"start":{"line":167,"column":12},"end":{"line":167,"column":26}},"55":{"start":{"line":169,"column":12},"end":{"line":169,"column":53}},"56":{"start":{"line":174,"column":12},"end":{"line":174,"column":49}},"57":{"start":{"line":179,"column":0},"end":{"line":232,"column":2}},"58":{"start":{"line":181,"column":4},"end":{"line":181,"column":25}},"59":{"start":{"line":184,"column":4},"end":{"line":186,"column":7}},"60":{"start":{"line":185,"column":8},"end":{"line":185,"column":21}},"61":{"start":{"line":189,"column":4},"end":{"line":189,"column":32}},"62":{"start":{"line":190,"column":4},"end":{"line":190,"column":43}},"63":{"start":{"line":193,"column":4},"end":{"line":193,"column":25}},"64":{"start":{"line":194,"column":4},"end":{"line":194,"column":27}},"65":{"start":{"line":197,"column":4},"end":{"line":197,"column":67}},"66":{"start":{"line":198,"column":4},"end":{"line":198,"column":86}},"67":{"start":{"line":199,"column":4},"end":{"line":199,"column":31}},"68":{"start":{"line":202,"column":4},"end":{"line":231,"column":6}},"69":{"start":{"line":204,"column":8},"end":{"line":230,"column":9}},"70":{"start":{"line":205,"column":12},"end":{"line":205,"column":92}},"71":{"start":{"line":207,"column":12},"end":{"line":207,"column":32}},"72":{"start":{"line":208,"column":12},"end":{"line":208,"column":32}},"73":{"start":{"line":211,"column":12},"end":{"line":227,"column":15}},"74":{"start":{"line":212,"column":16},"end":{"line":226,"column":17}},"75":{"start":{"line":213,"column":20},"end":{"line":213,"column":41}},"76":{"start":{"line":214,"column":20},"end":{"line":214,"column":82}},"77":{"start":{"line":215,"column":23},"end":{"line":226,"column":17}},"78":{"start":{"line":216,"column":20},"end":{"line":216,"column":41}},"79":{"start":{"line":217,"column":20},"end":{"line":217,"column":116}},"80":{"start":{"line":218,"column":23},"end":{"line":226,"column":17}},"81":{"start":{"line":219,"column":20},"end":{"line":219,"column":41}},"82":{"start":{"line":220,"column":20},"end":{"line":220,"column":96}},"83":{"start":{"line":221,"column":23},"end":{"line":226,"column":17}},"84":{"start":{"line":222,"column":20},"end":{"line":222,"column":41}},"85":{"start":{"line":223,"column":20},"end":{"line":223,"column":117}},"86":{"start":{"line":225,"column":20},"end":{"line":225,"column":47}},"87":{"start":{"line":229,"column":12},"end":{"line":229,"column":29}}},"branchMap":{"1":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":49,"column":8}},{"start":{"line":49,"column":8},"end":{"line":49,"column":8}}]},"2":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":13},"end":{"line":49,"column":89}},{"start":{"line":50,"column":13},"end":{"line":50,"column":86}},{"start":{"line":51,"column":13},"end":{"line":51,"column":90}}]},"3":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":12},"end":{"line":60,"column":12}},{"start":{"line":60,"column":12},"end":{"line":60,"column":12}}]},"4":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":20},"end":{"line":76,"column":20}},{"start":{"line":76,"column":20},"end":{"line":76,"column":20}}]},"5":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":20},"end":{"line":91,"column":20}},{"start":{"line":91,"column":20},"end":{"line":91,"column":20}}]},"6":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":25},"end":{"line":91,"column":63}},{"start":{"line":91,"column":68},"end":{"line":91,"column":82}}]},"7":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":27},"end":{"line":104,"column":27}},{"start":{"line":104,"column":27},"end":{"line":104,"column":27}}]},"8":{"line":104,"type":"binary-expr","locations":[{"start":{"line":104,"column":32},"end":{"line":104,"column":69}},{"start":{"line":105,"column":32},"end":{"line":105,"column":62}}]},"9":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":12},"end":{"line":143,"column":12}},{"start":{"line":143,"column":12},"end":{"line":143,"column":12}}]},"10":{"line":204,"type":"if","locations":[{"start":{"line":204,"column":8},"end":{"line":204,"column":8}},{"start":{"line":204,"column":8},"end":{"line":204,"column":8}}]},"11":{"line":204,"type":"binary-expr","locations":[{"start":{"line":204,"column":12},"end":{"line":204,"column":23}},{"start":{"line":204,"column":27},"end":{"line":204,"column":40}}]},"12":{"line":212,"type":"if","locations":[{"start":{"line":212,"column":16},"end":{"line":212,"column":16}},{"start":{"line":212,"column":16},"end":{"line":212,"column":16}}]},"13":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":23},"end":{"line":215,"column":23}},{"start":{"line":215,"column":23},"end":{"line":215,"column":23}}]},"14":{"line":218,"type":"if","locations":[{"start":{"line":218,"column":23},"end":{"line":218,"column":23}},{"start":{"line":218,"column":23},"end":{"line":218,"column":23}}]},"15":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":23},"end":{"line":221,"column":23}},{"start":{"line":221,"column":23},"end":{"line":221,"column":23}}]}},"code":["(function () { YUI.add('moodle-atto_recordrtc-videomodule', function (Y, NAME) {","","// TinyMCE recordrtc library functions.","// @package    tinymce_recordrtc.","// @author     Jesus Federico  (jesus [at] blindsidenetworks [dt] com).","// @copyright  2016 to present, Blindside Networks Inc.","// @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later.","","/** global: M */","/** global: bowser */","/** global: recordrtc */","/** global: player */","/** global: startStopBtn */","/** global: uploadBtn */","/** global: countdownSeconds */","/** global: countdownTicker */","/** global: recType */","/** global: mediaRecorder */","/** global: chunks */","/** global: blobSize */","/** global: maxUploadSize */","","/**"," * This function is initialized from PHP"," *"," * @param {Object}"," *            Y YUI instance"," */","Y.M.atto_recordrtc.view_init = function() {","    // Assignment of global variables.","    player = document.querySelector('video#player');","    startStopBtn = document.querySelector('button#start-stop');","    uploadBtn = document.querySelector('button#upload');","    recType = 'video';","    // Extract the numbers from the string, and convert to bytes.","    maxUploadSize = parseInt(recordrtc.maxfilesize.match(/\\d+/)[0]) * Math.pow(1024, 2);","","    // Show alert and redirect user if connection is not secure.","    Y.M.atto_recordrtc.check_secure();","    // Show alert if using non-ideal browser.","    Y.M.atto_recordrtc.check_browser();","","    // Run when user clicks on \"record\" button.","    startStopBtn.onclick = function() {","        var btn = this;","        btn.disabled = true;","","        // If button is displaying \"Start Recording\" or \"Record Again\".","        if ((btn.textContent === M.util.get_string('startrecording', 'tinymce_recordrtc')) ||","            (btn.textContent === M.util.get_string('recordagain', 'tinymce_recordrtc')) ||","            (btn.textContent === M.util.get_string('recordingfailed', 'tinymce_recordrtc'))) {","            // Hide alert-danger if it is shown.","            var alert = document.querySelector('div[id=alert-danger]');","            alert.parentElement.parentElement.classList.add('hide');","","            // Make sure the upload button is not shown.","            uploadBtn.parentElement.parentElement.classList.add('hide');","","            // Change look of recording button.","            if (!recordrtc.oldermoodle) {","                startStopBtn.classList.remove('btn-outline-danger');","                startStopBtn.classList.add('btn-danger');","            }","","            // Empty the array containing the previously recorded chunks.","            chunks = [];","            blobSize = 0;","","            // Initialize common configurations.","            var commonConfig = {","                // When the stream is captured from the microphone/webcam.","                onMediaCaptured: function(stream) {","                    // Make video stream available at a higher level by making it a property of btn.","                    btn.stream = stream;","","                    if (btn.mediaCapturedCallback) {","                        btn.mediaCapturedCallback();","                    }","                },","","                // Revert button to \"Record Again\" when recording is stopped.","                onMediaStopped: function(btnLabel) {","                    btn.textContent = btnLabel;","                },","","                // Handle recording errors.","                onMediaCapturingFailed: function(error) {","                    var btnLabel = null;","","                    // If Firefox and Permission Denied error.","                    if ((error.name === 'PermissionDeniedError') && bowser.firefox) {","                        InstallTrigger.install({","                            'Foo': {","                                // Link: https://addons.mozilla.org/firefox/downloads/latest/655146/addon-655146...","                                // ...-latest.xpi?src=dp-btn-primary.","                                URL: 'https://addons.mozilla.org/en-US/firefox/addon/enable-screen-capturing/',","                                toString: function() {","                                    return this.URL;","                                }","                            }","                        });","","                        btnLabel = M.util.get_string('startrecording', 'tinymce_recordrtc');","                    } else if ((error.name === 'DevicesNotFoundError') ||","                               (error.name === 'NotFoundError')) { // If Device Not Found error.","                        var alert = document.querySelector('div[id=alert-danger]');","                        alert.parentElement.parentElement.classList.remove('hide');","                        alert.textContent = M.util.get_string('inputdevicealert', 'tinymce_recordrtc') + ' ' + M.util.get_string('inputdevicealert', 'tinymce_recordrtc');","","                        btnLabel = M.util.get_string('recordingfailed', 'tinymce_recordrtc');","                    }","","                    // Proceed to treat as a stopped recording.","                    commonConfig.onMediaStopped(btnLabel);","                }","            };","","            // Show video tag without controls to view webcam stream.","            player.parentElement.parentElement.classList.remove('hide');","            player.controls = false;","","            // Capture audio+video stream from webcam/microphone.","            Y.M.atto_recordrtc.captureAudioVideo(commonConfig);","","            // When audio+video stream is successfully captured, start recording.","            btn.mediaCapturedCallback = function() {","                Y.M.atto_recordrtc.startRecording(recType, btn.stream);","            };","        } else { // If button is displaying \"Stop Recording\".","            // First of all clears the countdownTicker.","            clearInterval(countdownTicker);","","            // Disable \"Record Again\" button for 1s to allow background processing (closing streams).","            setTimeout(function() {","                btn.disabled = false;","            }, 1000);","","            // Stop recording.","            Y.M.atto_recordrtc.stopRecording(btn.stream);","","            // Change button to offer to record again.","            btn.textContent = M.util.get_string('recordagain', 'tinymce_recordrtc');","            if (!recordrtc.oldermoodle) {","                startStopBtn.classList.remove('btn-danger');","                startStopBtn.classList.add('btn-outline-danger');","            }","        }","    };","};","","// Setup to get audio+video stream from microphone/webcam.","Y.M.atto_recordrtc.captureAudioVideo = function(config) {","    Y.M.atto_recordrtc.captureUserMedia(","        // Media constraints.","        {","            audio: true,","            video: {","                width: {ideal: 640},","                height: {ideal: 480}","            }","        },","","        // Success callback.","        function(audioVideoStream) {","            // Set video player source to microphone+webcam stream, and play it back as it's recording.","            player.srcObject = audioVideoStream;","            player.play();","","            config.onMediaCaptured(audioVideoStream);","        },","","        // Error callback.","        function(error) {","            config.onMediaCapturingFailed(error);","        }","    );","};","","Y.M.atto_recordrtc.stopRecording = function(stream) {","    // Stop recording microphone stream.","    mediaRecorder.stop();","","    // Stop each individual MediaTrack.","    stream.getTracks().forEach(function(track) {","        track.stop();","    });","","    // Set source of video player.","    var blob = new Blob(chunks);","    player.src = URL.createObjectURL(blob);","","    // Enable controls for video player, and unmute.","    player.muted = false;","    player.controls = true;","","    // Show upload button.","    uploadBtn.parentElement.parentElement.classList.remove('hide');","    uploadBtn.textContent = M.util.get_string('attachrecording', 'tinymce_recordrtc');","    uploadBtn.disabled = false;","","    // Handle when upload button is clicked.","    uploadBtn.onclick = function() {","        // Trigger error if no recording has been made.","        if (!player.src || chunks === []) {","            return window.alert(M.util.get_string('norecordingfound', 'tinymce_recordrtc'));","        } else {","            var btn = uploadBtn;","            btn.disabled = true;","","            // Upload recording to server.","            Y.M.atto_recordrtc.uploadToServer(recType, function(progress, fileURLOrError) {","                if (progress === 'ended') { // Insert annotation in text.","                    btn.disabled = false;","                    Y.M.atto_recordrtc.insert_annotation(recType, fileURLOrError);","                } else if (progress === 'upload-failed') { // Show error message in upload button.","                    btn.disabled = false;","                    btn.textContent = M.util.get_string('uploadfailed', 'tinymce_recordrtc') + ' ' + fileURLOrError;","                } else if (progress === 'upload-failed-404') { // 404 error = File too large in Moodle.","                    btn.disabled = false;","                    btn.textContent = M.util.get_string('uploadfailed404', 'tinymce_recordrtc');","                } else if (progress === 'upload-aborted') {","                    btn.disabled = false;","                    btn.textContent = M.util.get_string('uploadaborted', 'tinymce_recordrtc') + ' ' + fileURLOrError;","                } else {","                    btn.textContent = progress;","                }","            });","","            return undefined;","        }","    };","};","","","}, '@VERSION@', {\"requires\": [\"moodle-atto_recordrtc-commonmodule\"]});","","}());"]};
}
var __cov_MR0XWcttYWjSqz_XjxsX7g = __coverage__['build/moodle-atto_recordrtc-videomodule/moodle-atto_recordrtc-videomodule.js'];
__cov_MR0XWcttYWjSqz_XjxsX7g.s['1']++;YUI.add('moodle-atto_recordrtc-videomodule',function(Y,NAME){__cov_MR0XWcttYWjSqz_XjxsX7g.f['1']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['2']++;Y.M.atto_recordrtc.view_init=function(){__cov_MR0XWcttYWjSqz_XjxsX7g.f['2']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['3']++;player=document.querySelector('video#player');__cov_MR0XWcttYWjSqz_XjxsX7g.s['4']++;startStopBtn=document.querySelector('button#start-stop');__cov_MR0XWcttYWjSqz_XjxsX7g.s['5']++;uploadBtn=document.querySelector('button#upload');__cov_MR0XWcttYWjSqz_XjxsX7g.s['6']++;recType='video';__cov_MR0XWcttYWjSqz_XjxsX7g.s['7']++;maxUploadSize=parseInt(recordrtc.maxfilesize.match(/\d+/)[0])*Math.pow(1024,2);__cov_MR0XWcttYWjSqz_XjxsX7g.s['8']++;Y.M.atto_recordrtc.check_secure();__cov_MR0XWcttYWjSqz_XjxsX7g.s['9']++;Y.M.atto_recordrtc.check_browser();__cov_MR0XWcttYWjSqz_XjxsX7g.s['10']++;startStopBtn.onclick=function(){__cov_MR0XWcttYWjSqz_XjxsX7g.f['3']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['11']++;var btn=this;__cov_MR0XWcttYWjSqz_XjxsX7g.s['12']++;btn.disabled=true;__cov_MR0XWcttYWjSqz_XjxsX7g.s['13']++;if((__cov_MR0XWcttYWjSqz_XjxsX7g.b['2'][0]++,btn.textContent===M.util.get_string('startrecording','tinymce_recordrtc'))||(__cov_MR0XWcttYWjSqz_XjxsX7g.b['2'][1]++,btn.textContent===M.util.get_string('recordagain','tinymce_recordrtc'))||(__cov_MR0XWcttYWjSqz_XjxsX7g.b['2'][2]++,btn.textContent===M.util.get_string('recordingfailed','tinymce_recordrtc'))){__cov_MR0XWcttYWjSqz_XjxsX7g.b['1'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['14']++;var alert=document.querySelector('div[id=alert-danger]');__cov_MR0XWcttYWjSqz_XjxsX7g.s['15']++;alert.parentElement.parentElement.classList.add('hide');__cov_MR0XWcttYWjSqz_XjxsX7g.s['16']++;uploadBtn.parentElement.parentElement.classList.add('hide');__cov_MR0XWcttYWjSqz_XjxsX7g.s['17']++;if(!recordrtc.oldermoodle){__cov_MR0XWcttYWjSqz_XjxsX7g.b['3'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['18']++;startStopBtn.classList.remove('btn-outline-danger');__cov_MR0XWcttYWjSqz_XjxsX7g.s['19']++;startStopBtn.classList.add('btn-danger');}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['3'][1]++;}__cov_MR0XWcttYWjSqz_XjxsX7g.s['20']++;chunks=[];__cov_MR0XWcttYWjSqz_XjxsX7g.s['21']++;blobSize=0;__cov_MR0XWcttYWjSqz_XjxsX7g.s['22']++;var commonConfig={onMediaCaptured:function(stream){__cov_MR0XWcttYWjSqz_XjxsX7g.f['4']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['23']++;btn.stream=stream;__cov_MR0XWcttYWjSqz_XjxsX7g.s['24']++;if(btn.mediaCapturedCallback){__cov_MR0XWcttYWjSqz_XjxsX7g.b['4'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['25']++;btn.mediaCapturedCallback();}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['4'][1]++;}},onMediaStopped:function(btnLabel){__cov_MR0XWcttYWjSqz_XjxsX7g.f['5']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['26']++;btn.textContent=btnLabel;},onMediaCapturingFailed:function(error){__cov_MR0XWcttYWjSqz_XjxsX7g.f['6']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['27']++;var btnLabel=null;__cov_MR0XWcttYWjSqz_XjxsX7g.s['28']++;if((__cov_MR0XWcttYWjSqz_XjxsX7g.b['6'][0]++,error.name==='PermissionDeniedError')&&(__cov_MR0XWcttYWjSqz_XjxsX7g.b['6'][1]++,bowser.firefox)){__cov_MR0XWcttYWjSqz_XjxsX7g.b['5'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['29']++;InstallTrigger.install({'Foo':{URL:'https://addons.mozilla.org/en-US/firefox/addon/enable-screen-capturing/',toString:function(){__cov_MR0XWcttYWjSqz_XjxsX7g.f['7']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['30']++;return this.URL;}}});__cov_MR0XWcttYWjSqz_XjxsX7g.s['31']++;btnLabel=M.util.get_string('startrecording','tinymce_recordrtc');}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['5'][1]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['32']++;if((__cov_MR0XWcttYWjSqz_XjxsX7g.b['8'][0]++,error.name==='DevicesNotFoundError')||(__cov_MR0XWcttYWjSqz_XjxsX7g.b['8'][1]++,error.name==='NotFoundError')){__cov_MR0XWcttYWjSqz_XjxsX7g.b['7'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['33']++;var alert=document.querySelector('div[id=alert-danger]');__cov_MR0XWcttYWjSqz_XjxsX7g.s['34']++;alert.parentElement.parentElement.classList.remove('hide');__cov_MR0XWcttYWjSqz_XjxsX7g.s['35']++;alert.textContent=M.util.get_string('inputdevicealert','tinymce_recordrtc')+' '+M.util.get_string('inputdevicealert','tinymce_recordrtc');__cov_MR0XWcttYWjSqz_XjxsX7g.s['36']++;btnLabel=M.util.get_string('recordingfailed','tinymce_recordrtc');}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['7'][1]++;}}__cov_MR0XWcttYWjSqz_XjxsX7g.s['37']++;commonConfig.onMediaStopped(btnLabel);}};__cov_MR0XWcttYWjSqz_XjxsX7g.s['38']++;player.parentElement.parentElement.classList.remove('hide');__cov_MR0XWcttYWjSqz_XjxsX7g.s['39']++;player.controls=false;__cov_MR0XWcttYWjSqz_XjxsX7g.s['40']++;Y.M.atto_recordrtc.captureAudioVideo(commonConfig);__cov_MR0XWcttYWjSqz_XjxsX7g.s['41']++;btn.mediaCapturedCallback=function(){__cov_MR0XWcttYWjSqz_XjxsX7g.f['8']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['42']++;Y.M.atto_recordrtc.startRecording(recType,btn.stream);};}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['1'][1]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['43']++;clearInterval(countdownTicker);__cov_MR0XWcttYWjSqz_XjxsX7g.s['44']++;setTimeout(function(){__cov_MR0XWcttYWjSqz_XjxsX7g.f['9']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['45']++;btn.disabled=false;},1000);__cov_MR0XWcttYWjSqz_XjxsX7g.s['46']++;Y.M.atto_recordrtc.stopRecording(btn.stream);__cov_MR0XWcttYWjSqz_XjxsX7g.s['47']++;btn.textContent=M.util.get_string('recordagain','tinymce_recordrtc');__cov_MR0XWcttYWjSqz_XjxsX7g.s['48']++;if(!recordrtc.oldermoodle){__cov_MR0XWcttYWjSqz_XjxsX7g.b['9'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['49']++;startStopBtn.classList.remove('btn-danger');__cov_MR0XWcttYWjSqz_XjxsX7g.s['50']++;startStopBtn.classList.add('btn-outline-danger');}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['9'][1]++;}}};};__cov_MR0XWcttYWjSqz_XjxsX7g.s['51']++;Y.M.atto_recordrtc.captureAudioVideo=function(config){__cov_MR0XWcttYWjSqz_XjxsX7g.f['10']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['52']++;Y.M.atto_recordrtc.captureUserMedia({audio:true,video:{width:{ideal:640},height:{ideal:480}}},function(audioVideoStream){__cov_MR0XWcttYWjSqz_XjxsX7g.f['11']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['53']++;player.srcObject=audioVideoStream;__cov_MR0XWcttYWjSqz_XjxsX7g.s['54']++;player.play();__cov_MR0XWcttYWjSqz_XjxsX7g.s['55']++;config.onMediaCaptured(audioVideoStream);},function(error){__cov_MR0XWcttYWjSqz_XjxsX7g.f['12']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['56']++;config.onMediaCapturingFailed(error);});};__cov_MR0XWcttYWjSqz_XjxsX7g.s['57']++;Y.M.atto_recordrtc.stopRecording=function(stream){__cov_MR0XWcttYWjSqz_XjxsX7g.f['13']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['58']++;mediaRecorder.stop();__cov_MR0XWcttYWjSqz_XjxsX7g.s['59']++;stream.getTracks().forEach(function(track){__cov_MR0XWcttYWjSqz_XjxsX7g.f['14']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['60']++;track.stop();});__cov_MR0XWcttYWjSqz_XjxsX7g.s['61']++;var blob=new Blob(chunks);__cov_MR0XWcttYWjSqz_XjxsX7g.s['62']++;player.src=URL.createObjectURL(blob);__cov_MR0XWcttYWjSqz_XjxsX7g.s['63']++;player.muted=false;__cov_MR0XWcttYWjSqz_XjxsX7g.s['64']++;player.controls=true;__cov_MR0XWcttYWjSqz_XjxsX7g.s['65']++;uploadBtn.parentElement.parentElement.classList.remove('hide');__cov_MR0XWcttYWjSqz_XjxsX7g.s['66']++;uploadBtn.textContent=M.util.get_string('attachrecording','tinymce_recordrtc');__cov_MR0XWcttYWjSqz_XjxsX7g.s['67']++;uploadBtn.disabled=false;__cov_MR0XWcttYWjSqz_XjxsX7g.s['68']++;uploadBtn.onclick=function(){__cov_MR0XWcttYWjSqz_XjxsX7g.f['15']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['69']++;if((__cov_MR0XWcttYWjSqz_XjxsX7g.b['11'][0]++,!player.src)||(__cov_MR0XWcttYWjSqz_XjxsX7g.b['11'][1]++,chunks===[])){__cov_MR0XWcttYWjSqz_XjxsX7g.b['10'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['70']++;return window.alert(M.util.get_string('norecordingfound','tinymce_recordrtc'));}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['10'][1]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['71']++;var btn=uploadBtn;__cov_MR0XWcttYWjSqz_XjxsX7g.s['72']++;btn.disabled=true;__cov_MR0XWcttYWjSqz_XjxsX7g.s['73']++;Y.M.atto_recordrtc.uploadToServer(recType,function(progress,fileURLOrError){__cov_MR0XWcttYWjSqz_XjxsX7g.f['16']++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['74']++;if(progress==='ended'){__cov_MR0XWcttYWjSqz_XjxsX7g.b['12'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['75']++;btn.disabled=false;__cov_MR0XWcttYWjSqz_XjxsX7g.s['76']++;Y.M.atto_recordrtc.insert_annotation(recType,fileURLOrError);}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['12'][1]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['77']++;if(progress==='upload-failed'){__cov_MR0XWcttYWjSqz_XjxsX7g.b['13'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['78']++;btn.disabled=false;__cov_MR0XWcttYWjSqz_XjxsX7g.s['79']++;btn.textContent=M.util.get_string('uploadfailed','tinymce_recordrtc')+' '+fileURLOrError;}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['13'][1]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['80']++;if(progress==='upload-failed-404'){__cov_MR0XWcttYWjSqz_XjxsX7g.b['14'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['81']++;btn.disabled=false;__cov_MR0XWcttYWjSqz_XjxsX7g.s['82']++;btn.textContent=M.util.get_string('uploadfailed404','tinymce_recordrtc');}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['14'][1]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['83']++;if(progress==='upload-aborted'){__cov_MR0XWcttYWjSqz_XjxsX7g.b['15'][0]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['84']++;btn.disabled=false;__cov_MR0XWcttYWjSqz_XjxsX7g.s['85']++;btn.textContent=M.util.get_string('uploadaborted','tinymce_recordrtc')+' '+fileURLOrError;}else{__cov_MR0XWcttYWjSqz_XjxsX7g.b['15'][1]++;__cov_MR0XWcttYWjSqz_XjxsX7g.s['86']++;btn.textContent=progress;}}}}});__cov_MR0XWcttYWjSqz_XjxsX7g.s['87']++;return undefined;}};};},'@VERSION@',{'requires':['moodle-atto_recordrtc-commonmodule']});
